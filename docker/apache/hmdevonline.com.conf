<VirtualHost *:443>
    ServerName hmdevonline.com

    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/hmdevonline.com/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/hmdevonline.com/privkey.pem

    # Reverse proxy to internal gateway (mesaging API Demo)
    ProxyPreserveHost On
    ProxyPass "/messaging-api/" "http://127.0.0.1:8080/messaging-api/"
    ProxyPassReverse "/messaging-api/" "http://127.0.0.1:8080/messaging-api/"

    # Reverse proxy to internal gateway (messaging Platform)
    ProxyPass "/messaging-platform/" "http://127.0.0.1:8082/messaging-platform/"
    ProxyPassReverse "/messaging-platform/" "http://127.0.0.1:8082/messaging-platform/"

    # Optional: minimal forwarding headers so backend knows scheme and client IP
    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Port "443"
    RequestHeader set X-Forwarded-For "%{REMOTE_ADDR}s"
    RequestHeader set X-Forwarded-Host "%{HTTP_HOST}s"

    ErrorLog ${APACHE_LOG_DIR}/hmdevonline.com-error.log
    CustomLog ${APACHE_LOG_DIR}/hmdevonline.com-access.log combined
</VirtualHost>

<VirtualHost *:80>
    ServerName hmdevonline.com
    Redirect permanent / https://hmdevonline.com/
</VirtualHost>
